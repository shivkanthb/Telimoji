var express = require('express'),
    imojiClient = new (require("imoji-node"))({
        apiKey: process.env.IMOJI_API_KEY,
        apiSecret: process.env.IMOJI_API_SECRET
    }),
    app = express();

/* GET home page. */
app.get('/featured', function (req, res) {
    imojiClient.featured({
        numResults: req.query.limit || 25
    })
        .then(function (featured) {
            res.status(200).json(featured);
        })
        .catch(function (err) {
            console.error(err);
            res.status(500);
        });
});

app.get('/categories', function (req, res) {
    imojiClient.categories({
        classification: req.query.classification
    })
        .then(function (categories) {
            res.status(200).json(categories);
        })
        .catch(function (err) {
            console.error(err);
            res.status(500);
        });
});

app.get('/search', function (req, res) {
    imojiClient.search({
        query: req.query.query,
        offset: (req.query.offset || 0),
        limit: req.query.limit || 50,
        locale: req.query.locale
    })
        .then(function (searchResults) {
            res.status(200).json(searchResults);
        })
        .catch(function (err) {
            console.error(err);
            res.status(500);
        });
});

app.listen(8888);
console.log("Server ready on port 8888!");
